pch = c(4, 3), bg = "white")
axis(1, at = 0:12)
abline(h = seq(0, 0.25, by = 0.05), v = 0:12, lty = 2, col = "grey")
F_emp = table(traffic_data)
F_teor = dpois(as.numeric(names(F_emp)), lambda = est_lambda)
plot(0:12, F_teor,type = "p", ylim = c(0, 0.25), pch = 4, col = "green4",
las = 1, lwd = 2, main = "Funkcje prawdopodobieństwa", xaxt = "n",
xlab = expression(italic("k")), ylab = expression("P"~italic("(x=k)")))
points(F_emp / length(traffic_data), type = "p", pch = 3, col = "red3")
legend("topright", legend = c("teoretyczna", "empiryczna"), col = c("green4", "red3"),
pch = c(4, 3), bg = "white")
axis(1, at = 0:12)
abline(h = seq(0, 0.25, by = 0.05), v = 0:12, lty = 2, col = "grey")
F_emp = table(traffic_data)
F_teor = dpois(as.numeric(names(F_emp)), lambda = est_lambda)
plot(0:12, F_teor,type = "p", ylim = c(0, 0.25), pch = 4, col = "green4",
las = 1, lwd = 2, main = "Funkcje prawdopodobieństwa", xaxt = "n",
xlab = expression(italic("k")), ylab = expression("P" ~ italic("(x=k)")))
points(F_emp / length(traffic_data), type = "p", pch = 3, col = "red3")
legend("topright", legend = c("teoretyczna", "empiryczna"), col = c("green4", "red3"),
pch = c(4, 3), bg = "white")
axis(1, at = 0:12)
abline(h = seq(0, 0.25, by = 0.05), v = 0:12, lty = 2, col = "grey")
unzip('mstall.zip', files = 'CREOTECH.mst')
df_CREOTECH = read.csv('CREOTECH.mst')
View(df_CREOTECH)
unzip('mstall.zip', files = 'CREOTECH.mst')
df_CREOTECH = read.csv('CREOTECH.mst')
names(df_CREOTECH) = c('ticker', 'date', 'open', 'high', 'low', 'close','vol')
df_CREOTECH$date = as.Date.character(df_CREOTECH$date, format ='%Y%m%d')
library(lubridate)
install.packages(lubridate)
install.packages("lubridate")
library(lubridate)
latest_date_CREOTECH = max(df_CREOTECH$date)
df_CREOTECH = df_CREOTECH[which(df_CREOTECH$date >= latest_date_CREOTECH %m-% months(12)),]
library(lubridate)
latest_date_CREOTECH = max(df_CREOTECH$date)
df_CREOTECH = df_CREOTECH[which(df_CREOTECH$date >= latest_date_CREOTECH %m-% months(12)),]
df_CREOTECH$high_diff = with(df_CREOTECH, c(NA, 100*diff(high)/high[-length(high)]))
df_CREOTECH$high_diff2 = with(df_CREOTECH, c(NA, 100*diff(high)/high))
df_CREOTECH$high_diff = with(df_CREOTECH, c(NA, 100*diff(high)/high[-length(high)]))
hist(df_CREOTECH$high_diff)
hist(df_CREOTECH$high_diff, breaks = 11)
hist(df_CREOTECH$high_diff, breaks = 130)
hist(df_CREOTECH$high_diff, breaks = 50)
hist(df_CREOTECH$high_diff, breaks = 51
)
hist(df_CREOTECH$high_diff,
breaks = 20, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
grid()
hist(df_CREOTECH$high_diff,
breaks = 20, prob = F,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = F,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
grid()
pdf.options(encoding='ISOLatin2')
traffic_data =  scan('skrety.txt')
est_lambda = mean(traffic_data)
K = 1000
bootstrap_lambda = replicate(K, {
boot_dane = sample(traffic_data, replace = T)
return(mean(boot_dane))
})
sd_est_lambda = sd(bootstrap_lambda)
F_emp = table(traffic_data)
F_teor = dpois(as.numeric(names(F_emp)), lambda = est_lambda)
plot(0:12, F_teor,type = "p", ylim = c(0, 0.25), pch = 4, col = "green4",
las = 1, lwd = 2, main = "Funkcje prawdopodobieństwa", xaxt = "n",
xlab = expression(italic("k")), ylab = expression("P" ~ italic("(x=k)")))
points(F_emp / length(traffic_data), type = "p", pch = 3, col = "red3")
legend("topright", legend = c("teoretyczna", "empiryczna"), col = c("green4", "red3"),
pch = c(4, 3), bg = "white")
axis(1, at = 0:12)
abline(h = seq(0, 0.25, by = 0.05), v = 0:12, lty = 2, col = "grey")
unzip('mstall.zip', files = 'CREOTECH.mst')
df_CREOTECH = read.csv('CREOTECH.mst')
names(df_CREOTECH) = c('ticker', 'date', 'open', 'high', 'low', 'close','vol')
df_CREOTECH$date = as.Date.character(df_CREOTECH$date, format ='%Y%m%d')
library(lubridate)
latest_date_CREOTECH = max(df_CREOTECH$date)
df_CREOTECH = df_CREOTECH[which(df_CREOTECH$date >= latest_date_CREOTECH %m-% months(12)),]
df_CREOTECH$high_diff = with(df_CREOTECH, c(NA, 100*diff(high)/high[-length(high)]))
View(df_CREOTECH)
est_mean = mean(df_CREOTECH$high_diff, na.rm = TRUE)
est_var = var(df_CREOTECH$high_diff, na.rm = TRUE)
f_norm_teor = dnorm(seq(min(df_CREOTECH$high_diff, na.rm = T),
max(df_CREOTECH$high_diff, na.rm = T)),
mean = est_mean, sd = sqrt(est_var))
hist(df_CREOTECH$high_diff,
breaks = 40, prob = F,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = F,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
lines(f_norm_teor)
grid()
x = seq(min(df_CREOTECH$high_diff, na.rm = T),
max(df_CREOTECH$high_diff, na.rm = T))
f_norm_teor = dnorm(x, mean = est_mean, sd = sqrt(est_var))
hist(df_CREOTECH$high_diff,
breaks = 40, prob = F,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
lines(x, f_norm_teor)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
lines(x, f_norm_teor)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = 'skyblue')
lines(x, f_norm_teor)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = 'skyblue')
lines(x, f_norm_teor, col = 'darkorchid4')
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = 'skyblue')
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
grid()
x = seq(min(df_CREOTECH$high_diff, na.rm = T),
max(df_CREOTECH$high_diff, na.rm = T), by = 0.1)
f_norm_teor = dnorm(x, mean = est_mean, sd = sqrt(est_var))
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = 'skyblue')
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = 'coral')
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = 'bisque')
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = 'darkgoldenrod1')
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = Porównanie wykresów, col = 'darkgoldenrod1')
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1')
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1')
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."), col = c("darkgoldenrod1", "darkorchid4"),
pch = c(4, 3), bg = "white")
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
col = c("darkgoldenrod1", "darkorchid4"),
lty = c(NA, 1), bg = "white")
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
col = c("darkgoldenrod1", "darkorchid4"),
lty = c(NA, 1), lwd = c(NA, 2), bg = "white")
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
col = c("darkgoldenrod1", "darkorchid4"),
lty = c(NA, 1), lwd = c(NA, 2))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
col = c("darkgoldenrod1", "darkorchid4"),
lty = c(NA, 1), lwd = c(NA, 2),
fill = c("darkgoldenrod1", NA))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
col = c("darkgoldenrod1", "darkorchid4"),
fill = c("darkgoldenrod1", NA))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
col = c("darkgoldenrod1", "darkorchid4"),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
shapiro.test(df_CREOTECH$high_diff)
sum(df_CREOTECH$high_diff >= -0.5 & df_CREOTECH$high_diff <= 0)
sum(df_CREOTECH$high_diff >= -0.5 & df_CREOTECH$high_diff <= 0 & !is.na(df_CREOTECH$high_diff))
sum(df_CREOTECH$high_diff >= -0.5 & df_CREOTECH$high_diff <= 0 & !is.na(df_CREOTECH$high_diff)) / length(df_CREOTECH$high_diff)
table(df_CREOTECH)
table(df_CREOTECH$high_diff)
hist_data <- hist(df_CREOTECH$high_diff, breaks = "FD", plot = FALSE, prob = TRUE)
density_for_range <- hist_data$density[hist_data$mids >= -0.5 & hist_data$mids <= 0]
density_for_range
hist(df_CREOTECH$high_diff,
breaks = "FD", prob = F,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = F,
xlab = 'Zmiana najwyższego kursu dziennego [%] ',
ylab = 'Częstość występowania',
xlim = c(-10, 15),
main = paste('Histogram procentowych zmian kursu', 'CREOTECH'), col = '#DC143C')
grid()
hist(df_CREOTECH$high_diff, breaks = "FD", prob = TRUE)
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
# lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
# lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
# legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
#               fill = c("darkgoldenrod1", "darkorchid4"))
grid()
hist_data <- hist(df_CREOTECH$high_diff, breaks = "FD", plot = FALSE, prob = TRUE)
bin_indices <- which(hist_data$mids >= -0.5 & hist_data$mids <= 0)
proportion_for_range <- sum(hist_data$counts[bin_indices]) / sum(hist_data$counts)
density_for_range <- hist_data$density[bin_indices]
print(proportion_for_range)
print(density_for_range)
hist(df_CREOTECH$high_diff,
breaks = 20, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
# lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
# legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
#               fill = c("darkgoldenrod1", "darkorchid4"))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
# lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
# legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
#               fill = c("darkgoldenrod1", "darkorchid4"))
grid()
length(df_CREOTECH$high_diff)
length(df_CREOTECH$high_diff & !is.na(df_CREOTECH$high_diff))
non_missing_count <- sum(!is.na(df_CREOTECH$high_diff))
print(non_missing_count)
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
curve(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
points(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
points(x, f_norm_teor, col = 'darkorchid4', lwd = 1)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
pnorm(0, mean = est_mean, sd = sqrt(est_var)) - pnorm(-0.5, mean = est_mean, sd = sqrt(est_var))
hist(df_CREOTECH$high_diff,
breaks = 40, prob = T,
xlab = 'x',
ylab = 'f(x)',
xlim = c(-10, 15),
main = "Porównanie wykresów", col = 'darkgoldenrod1',
las = 1)
lines(x, f_norm_teor, col = 'darkorchid4', lwd = 2)
legend("topright", legend = c("wartości empiryczne", "teoretyczna f. gęstości prawd."),
fill = c("darkgoldenrod1", "darkorchid4"))
grid()
length(df_CREOTECH$high_diff)
length(df_CREOTECH$high_diff, na.rm = TRUE)
length(na.omit(df_CREOTECH$high_diff))
n = length(na.omit(df_CREOTECH$high_diff))
conf_level = 0.90 # 0.9 0.95, 0.99 - gamma
S = sd(df_CREOTECH$high_diff, na.rm = TRUE)
w = S*qt((1+conf_level)/2, n-1)/sqrt(n)
mean_conf_int = c(est_mean - w, est_mean + w)
a = (1 - conf_level)/2; b = (1 - conf_level)/2
var_conf_int = c((n-1)*S^2/qchisq(1-b,n-1), (n-1)*S^2/qchisq(a,n-1))
conf_level = 0.90 # 0.9 0.95, 0.99 - gamma
S = sd(df_CREOTECH$high_diff, na.rm = TRUE)
w = S*qt((1+conf_level)/2, n-1)/sqrt(n)
mean_conf_int_90 = c(est_mean - w, est_mean + w)
crit_val1 = (1 - conf_level)/2
crit_val2 = 1 - (1 - conf_level)/2
var_conf_int_90 = c((n-1)*S^2/qchisq(crit_val2, n-1), (n-1)*S^2/qchisq(crit_val1, n-1))
conf_level = 0.95
S = sd(df_CREOTECH$high_diff, na.rm = TRUE)
w = S*qt((1+conf_level)/2, n-1)/sqrt(n)
mean_conf_int_95 = c(est_mean - w, est_mean + w)
crit_val1 = (1 - conf_level)/2
crit_val2 = 1 - (1 - conf_level)/2
var_conf_int_95 = c((n-1)*S^2/qchisq(crit_val2, n-1), (n-1)*S^2/qchisq(crit_val1, n-1))
conf_level = 0.99
S = sd(df_CREOTECH$high_diff, na.rm = TRUE)
w = S*qt((1+conf_level)/2, n-1)/sqrt(n)
mean_conf_int_99 = c(est_mean - w, est_mean + w)
crit_val1 = (1 - conf_level)/2
crit_val2 = 1 - (1 - conf_level)/2
var_conf_int_99 = c((n-1)*S^2/qchisq(crit_val2, n-1), (n-1)*S^2/qchisq(crit_val1, n-1))
df_summary = data.frame(Poziom_ufności = c("90 %", "95 %", "99 %"),
Przedział_Średnia = c(mean_conf_int_90, mean_conf_int_95, mean_conf_int_99),
Przedział_Wariancja = c(var_conf_int_90, var_conf_int_95, var_conf_int_99))
df_summary = data.frame(Poziom_ufności = c("90 %", "95 %", "99 %"),
Przedział_Średnia = c(mean_conf_int_90, mean_conf_int_95, mean_conf_int_99),
Przedział_Wariancja = c(var_conf_int_90, var_conf_int_95, var_conf_int_99))
print(df_summary)
